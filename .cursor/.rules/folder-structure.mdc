---
alwaysApply: true
---
### ğŸ“ `src/infrastructure/` - Infrastructure Layer (ğŸ§± Implementations)

**Restrictions**:
- âœ… Can import from `domain/` and `application/`
- âŒ CANNOT import from `interfaces/`

**Allowed subfolders**:

#### `infrastructure/database/`
- **Content**: Repository implementations and ORM
- **Subfolders**:
  - `drizzle/`: Drizzle configuration (schema, client)
  - `repositories/`: Repository implementations
    - **Format**: `drizzle-*.repository.ts`
    - **Examples**: `drizzle-user.repository.ts`, `drizzle-appointment.repository.ts`

#### `infrastructure/notifications/`
- **Content**: Notification strategies (Strategy Pattern)
- **Format**: `*.strategy.ts`
- **Examples**: `email.strategy.ts`, `sms.strategy.ts`, `push.strategy.ts`
- **Also includes**: `notification-strategy.factory.ts`

#### `infrastructure/calendar/`
- **Content**: External integrations (Google Calendar, etc.)
- **Format**: `*.service.ts`
- **Examples**: `google-calendar.service.ts`

---

### ğŸ“ `src/interfaces/` - Interface Layer (ğŸŒ HTTP Adapters)

**Restrictions**:
- âœ… Can import from `domain/`, `application/` and `infrastructure/`
- **Note**: It's the outermost layer, exposes the application to the world

**Allowed subfolders**:

#### `interfaces/http/controllers/`
- **Content**: HTTP controllers (NestJS)
- **Format**: `*.controller.ts`
- **Examples**: `auth.controller.ts`, `appointment.controller.ts`
- **Rule**: Controllers must be THIN - only receive requests and call use cases

#### `interfaces/http/guards/`
- **Content**: Authentication/authorization guards
- **Format**: `*.guard.ts`
- **Examples**: `jwt-auth.guard.ts`

#### `interfaces/http/mappers/`
- **Content**: DTO â†” Domain Entity mappers
- **Format**: `*.mapper.ts`
- **Rule**: Transform HTTP DTOs to domain objects and vice versa

#### `interfaces/providers.ts`
- **Content**: Dependency injection configuration (NestJS)
- **Format**: `providers.ts` (single file or per module)
- **Rule**: Maps interfaces with concrete implementations

---

### ğŸ“ `src/shared/` - Shared Utilities

**Content**:
- Helpers, utilities, constants
- Pure functions without framework dependencies

**Restrictions**:
- âŒ Must NOT contain business logic
- âŒ Must NOT import from other layers (must be independent)

---

## Location Verification

Before creating any new file, follow these steps:

1. **Identify the layer**: What responsibility does the file have?
2. **Consult `folder_structure.md`**: Verify the exact location
3. **Verify dependencies**: What can it import according to its layer?
4. **Validate format**: Does the name follow naming conventions?

## Strict Prohibitions

- âŒ DO NOT create files outside these folders
- âŒ DO NOT mix responsibilities from different layers
- âŒ DO NOT import from incorrect layers (see `dependencies.mdc`)
