---
alwaysApply: true
---
### ğŸ“ `src/infrastructure/` - Capa de Infraestructura (ğŸ§± Implementaciones)

**Restricciones**:
- âœ… Puede importar de `domain/` y `application/`
- âŒ NO puede importar de `interfaces/`

**Subcarpetas permitidas**:

#### `infrastructure/database/`
- **Contenido**: Implementaciones de repositorios y ORM
- **Subcarpetas**:
  - `prisma/`: ConfiguraciÃ³n de Prisma (schema, client)
  - `repositories/`: Implementaciones de repositorios
    - **Formato**: `prisma-*.repository.ts`
    - **Ejemplos**: `prisma-user.repository.ts`, `prisma-appointment.repository.ts`

#### `infrastructure/notifications/`
- **Contenido**: Estrategias de notificaciÃ³n (Strategy Pattern)
- **Formato**: `*.strategy.ts`
- **Ejemplos**: `email.strategy.ts`, `sms.strategy.ts`, `push.strategy.ts`
- **TambiÃ©n incluye**: `notification-strategy.factory.ts`

#### `infrastructure/calendar/`
- **Contenido**: Integraciones externas (Google Calendar, etc.)
- **Formato**: `*.service.ts`
- **Ejemplos**: `google-calendar.service.ts`

---

### ğŸ“ `src/interfaces/` - Capa de Interfaz (ğŸŒ Adaptadores HTTP)

**Restricciones**:
- âœ… Puede importar de `domain/`, `application/` e `infrastructure/`
- **Nota**: Es la capa mÃ¡s externa, expone la aplicaciÃ³n al mundo

**Subcarpetas permitidas**:

#### `interfaces/http/controllers/`
- **Contenido**: Controladores HTTP (NestJS)
- **Formato**: `*.controller.ts`
- **Ejemplos**: `auth.controller.ts`, `appointment.controller.ts`
- **Regla**: Controladores deben ser DELGADOS - solo reciben requests y llaman a casos de uso

#### `interfaces/http/guards/`
- **Contenido**: Guards de autenticaciÃ³n/autorizaciÃ³n
- **Formato**: `*.guard.ts`
- **Ejemplos**: `jwt-auth.guard.ts`

#### `interfaces/http/mappers/`
- **Contenido**: Mappers DTO â†” Entidad de Dominio
- **Formato**: `*.mapper.ts`
- **Regla**: Transforman DTOs HTTP a objetos de dominio y viceversa

#### `interfaces/providers.ts`
- **Contenido**: ConfiguraciÃ³n de inyecciÃ³n de dependencias (NestJS)
- **Formato**: `providers.ts` (archivo Ãºnico o por mÃ³dulo)
- **Regla**: Mapea interfaces con implementaciones concretas

---

### ğŸ“ `src/shared/` - Utilidades Compartidas

**Contenido**:
- Helpers, utilities, constantes
- Funciones puras sin dependencias de frameworks

**Restricciones**:
- âŒ NO debe contener lÃ³gica de negocio
- âŒ NO debe importar de otras capas (debe ser independiente)

---

## VerificaciÃ³n de UbicaciÃ³n

Antes de crear cualquier archivo nuevo, seguir estos pasos:

1. **Identificar la capa**: Â¿QuÃ© responsabilidad tiene el archivo?
2. **Consultar `folder_structure.md`**: Verificar la ubicaciÃ³n exacta
3. **Verificar dependencias**: Â¿De quÃ© puede importar segÃºn su capa?
4. **Validar formato**: Â¿El nombre sigue las convenciones de nomenclatura?

## Prohibiciones Estrictas

- âŒ NO crear archivos fuera de estas carpetas
- âŒ NO mezclar responsabilidades de diferentes capas
- âŒ NO importar desde capas incorrectas (ver `dependencies.mdc`)
